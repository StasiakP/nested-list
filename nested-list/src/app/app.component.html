<ng-container *ngIf="tasksExpandable">
  <div class="flex flex-row mx-4">
    <div class="grow font-bold ml-28">NAME</div>
    <div class="w-24 font-bold">START</div>
    <div class="w-24 font-bold">END</div>
    <div class="w-24 font-bold">PRIORITY</div>
    <div class="w-24 font-bold">PROGRESS</div>
  </div>
  <ng-container *ngFor="let task of tasksExpandable">
    <ng-container
      [ngTemplateOutlet]="desktopTaskTile"
      [ngTemplateOutletContext]="{ task: task, indentLevel: 0 }"
    >
    </ng-container>
  </ng-container>
</ng-container>

<ng-template #desktopTaskTile let-task="task" let-indentLevel="indentLevel">
  <div
    [class]="indentLevel === 2 ? 'ml-20' : indentLevel === 1 ? 'ml-12' : ''"
    class="flex flex-row rounded-xl bg-white mb-2 relative mx-4 items-center"
  >
    <fa-icon
      *ngIf="indentLevel"
      [icon]="faArrowTurnUp"
      class="text-red-800 mr-1 arrow-icon absolute -left-6"
    ></fa-icon>
    <div
      class="rounded-full w-3 h-3 absolute task-dot"
      [class]="
        task.status === statusEnum.Done
          ? 'bg-green-800'
          : task.status === statusEnum.InProgress
            ? 'bg-red-800'
            : 'bg-gray-400'
      "
    ></div>
    <div class="grow flex py-3 px-6">
      <div class="flex flex-col">
        <span class="font-semibold">{{ task.name }}</span>
        <div class="text-xs min-h-7 flex items-center">
          {{ task.taskNumber }}
          <button
            *ngIf="task.childTasks.length"
            class="ml-2 rounded border-solid border-2 border-red-800 text-red-800 px-2 py-1"
            (click)="toggleRowVisibility(task.id)"
          >
            <fa-icon
              [icon]="faArrowTurnUp"
              class="text-red-800 mr-1 arrow-icon"
            ></fa-icon>
            {{ task.childTasks.length }}
          </button>
        </div>
      </div>
    </div>
    <div class="w-24 flex items-center">
      <fa-icon [icon]="faCalendar" class="text-gray-400 mr-1"></fa-icon
      >{{ task.startDate | dateFormatter }}
    </div>
    <div class="w-24 flex items-center">
      <fa-icon [icon]="faCalendar" class="text-gray-400 mr-1"></fa-icon
      >{{ task.endDate | dateFormatter }}
    </div>
    <div class="w-24 flex items-center">
      <fa-icon
        [icon]="faFlag"
        class="mr-1"
        [class]="
          task.priority === priorityEnum.High
            ? 'text-red-500'
            : task.priority === priorityEnum.Medium
              ? 'text-orange-500'
              : 'text-gray-400'
        "
      ></fa-icon
      ><span class="font-semibold">{{ task.priority }}</span>
    </div>
    <div class="w-24 flex items-center">
      <fa-icon [icon]="faSignal" class="text-gray-400 mr-1"></fa-icon
      >{{ task.percentageOfProgress + "%" }}
    </div>
  </div>
  <ng-container *ngIf="task.isExpanded">
    <ng-container
      *ngFor="let childTask of task.childTasks"
      [ngTemplateOutlet]="desktopTaskTile"
      [ngTemplateOutletContext]="{
        task: childTask,
        indentLevel: indentLevel + 1,
      }"
    >
    </ng-container>
  </ng-container>
</ng-template>

<ng-template #mobileTaskTile let-task="task"> </ng-template>
